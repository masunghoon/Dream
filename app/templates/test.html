{% extends 'base.html' %}
{% block content %}
<table>
    <tr>
        <td style="width: 35%;">
            <select class="form-control" data-bind='options: sampleProductCategories, optionsText: "name", optionsCaption: "Select...", value: category'> </select>
        </td>
        <td data-bind="with: category" style="width:35%;">
            <select class="form-control" data-bind='options: products, optionsText: "range", optionsCaption: "Select...", value: $parent.product'> </select>
        </td>
        <td class='price' data-bind='with: product' style="width:30%;">
            <span data-bind='text: dueDate'> </span>
        </td>
    </tr>
</table>
{% endblock %}
{% block scripts %}
<script type="text/javascript">
var sampleProductCategories = new Array();

var Cart = function() {
    var self = this;
    self.ajax = function(uri, method, data) {
        var request = {
            url: uri,
            type: method,
            contentType: "application/json",
            accepts: "application/json",
            cache: false,
            dataType: 'json',
            data: JSON.stringify(data),
            async: false,
            error: function(jqXHR) {
                console.log("ajax error " + jqXHR.status);
            }
        };
        return $.ajax(request);
    };
   
    self.ajax('/api/getUserDday','GET').done(function(res) {
        sampleProductCategories = res.data;
    });

    self.category = ko.observable();
    self.product = ko.observable();
    // Whenever the category changes, reset the product selection
    //self.category.subscribe(function() {
    //    self.product(undefined);
    //});
};

ko.applyBindings(new Cart());
</script>
{% endblock %}
